<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Biyokimyasal Test YorumlayÄ±cÄ± </title>
<style>
:root{
  --bg1:#f0f9ff; --bg2:#e0f2fe;
  --card:#ffffff; --text:#0f172a; --muted:#51607a;
  --good:#16a34a; --warn:#f59e0b; --bad:#dc2626; --accent:#2563eb;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
}
html,body{margin:0;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:var(--text)}
.container{max-width:1100px;margin:28px auto;padding:18px}
h1{margin:0 0 10px;color:#123e8a}
.grid{display:grid;grid-template-columns:1fr 380px;gap:18px}
.card{background:var(--card);padding:18px;border-radius:14px;box-shadow:0 10px 30px rgba(2,6,23,.08)}
label{display:block;font-weight:600;color:var(--muted);margin-top:10px}
.input-row{display:flex;gap:10px;align-items:center;margin-top:8px}
input[type=number], select{padding:10px;border-radius:10px;border:1px solid #dbeafe;background:#fbfdff;color:var(--text);width:100%}
.test-item{padding:12px;border-radius:10px;border:1px solid #eef2ff;background:#fbfdff;margin-bottom:10px}
.ref{font-size:12px;color:var(--muted);margin-top:6px}
button.primary{margin-top:14px;padding:12px 16px;border-radius:12px;border:none;background:linear-gradient(135deg,var(--accent),#3b82f6);color:white;font-weight:700;cursor:pointer}
.result{margin-top:12px;padding:12px;border-radius:12px;font-size:14px}
.result.good{background:#ecfdf5;border-left:6px solid var(--good)}
.result.warn{background:#fffbeb;border-left:6px solid var(--warn)}
.result.bad{background:#fef2f2;border-left:6px solid var(--bad)}
.small-muted{font-size:13px;color:var(--muted);margin-top:10px}
.privacy{font-size:13px;color:#475569;text-align:center;margin-top:18px}
@media(max-width:980px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ§ª Biyokimyasal Test YorumlayÄ±cÄ± </h1>

  <div class="grid">
    <div class="card">
      <!-- KiÅŸisel bilgiler -->
      <label for="gender">Cinsiyet</label>
      <select id="gender" aria-label="cinsiyet">
        <option value="female">KadÄ±n</option>
        <option value="male">Erkek</option>
      </select>

      <div class="input-row">
        <div style="flex:1">
          <label for="age">YaÅŸ</label>
          <input type="number" id="age" min="0" max="120" placeholder="YaÅŸ (yÄ±l)" />
        </div>
        <div style="width:160px">
          <label for="pregnancy">Gebelik</label>
          <select id="pregnancy" aria-label="gebelik">
            <option value="no">Gebe DeÄŸil</option>
            <option value="yes">Gebe</option>
          </select>
        </div>
      </div>

      <hr style="margin:14px 0;border:none;border-top:1px solid #eef2ff" />

      <!-- Testler listesi (tÃ¼m orijinal testler) -->
      <div id="testsContainer">
        <!-- JS dolduracak -->
      </div>

      <button class="primary" id="analyzeBtn">SonuÃ§larÄ± Yorumla</button>
      <div class="small-muted">UyarÄ±: Bu araÃ§ bilgilendirme amaÃ§lÄ±dÄ±r ve kesin tanÄ± yerine geÃ§mez.</div>
    </div>

    <div class="card">
      <strong>Analiz Ã–zeti</strong>
      <div id="summaryArea" style="margin-top:12px;color:#213547">
        HenÃ¼z analiz yapÄ±lmadÄ±.
      </div>

      <div class="privacy" id="privacyNote">
        Bu sayfaya girilen bilgiler yalnÄ±zca cihazÄ±nÄ±zda iÅŸlenir; kaydedilmez, saklanmaz ve Ã¼Ã§Ã¼ncÃ¼ kiÅŸilerle paylaÅŸÄ±lmaz.
      </div>
    </div>
  </div>
</div>

<script>
// ----- Test tanÄ±mlarÄ± (varsayÄ±lan referanslar) -----
// Not: bazÄ± testler iÃ§in cinsiyete/gebeliÄŸe gÃ¶re dÃ¼zeltme uygulanacak (kodda).
const tests = [
  {key:'glukoz', label:'AÃ§lÄ±k plazma glukozu', unit:'mg/dL', ref:{low:70, high:100}},
  {key:'ure', label:'Ãœre (BUN)', unit:'mg/dL', ref:{low:10, high:50}},
  {key:'kreatinin', label:'Kreatinin', unit:'mg/dL', ref:{maleLow:0.7,maleHigh:1.3,femaleLow:0.6,femaleHigh:1.1}},
  {key:'urikAsit', label:'Ãœrik asit', unit:'mg/dL', ref:{maleLow:3.5,maleHigh:7.2,femaleLow:2.6,femaleHigh:6.0}},
  {key:'totalProtein', label:'Total protein', unit:'g/dL', ref:{low:6.4,high:8.3}},
  {key:'albumin', label:'Albumin', unit:'g/dL', ref:{low:3.5,high:5.0}},
  {key:'alt', label:'ALT (alanin aminotransferaz)', unit:'U/L', ref:{low:0,high:45}},
  {key:'ast', label:'AST (aspartat aminotransferaz)', unit:'U/L', ref:{low:0,high:35}},
  {key:'ggt', label:'GGT (gamma-glutamil transferaz)', unit:'U/L', ref:{low:0,high:55}},
  {key:'alp', label:'ALP (alkalen fosfataz)', unit:'U/L', ref:{low:40,high:130}},
  {key:'totalBilirubin', label:'Total bilirubin', unit:'mg/dL', ref:{low:0.2,high:1.2}},
  {key:'direktBilirubin', label:'Direkt bilirubin', unit:'mg/dL', ref:{low:0,high:0.3}},
  {key:'totalKolesterol', label:'Total kolesterol', unit:'mg/dL', ref:{low:0,high:200}},
  {key:'hdlKolesterol', label:'HDL kolesterol', unit:'mg/dL', ref:{maleLow:40,maleHigh:100,femaleLow:50,femaleHigh:100}},
  {key:'ldlKolesterol', label:'LDL kolesterol', unit:'mg/dL', ref:{low:0, high:130}},
  {key:'trigliserid', label:'Trigliserid', unit:'mg/dL', ref:{low:0,high:150}},
  {key:'sodyum', label:'Sodyum (Na)', unit:'mmol/L', ref:{low:135,high:145}},
  {key:'potasyum', label:'Potasyum (K)', unit:'mmol/L', ref:{low:3.5,high:5.1}},
  {key:'klor', label:'Klor (Cl)', unit:'mmol/L', ref:{low:98,high:107}},
  {key:'kalsiyum', label:'Kalsiyum (Ca)', unit:'mg/dL', ref:{low:8.5,high:10.5}},
  {key:'fosfor', label:'Fosfor (P)', unit:'mg/dL', ref:{low:2.5,high:4.5}},
  {key:'demir', label:'Demir (Fe)', unit:'Âµg/dL', ref:{low:50,high:170}},
  {key:'ferritin', label:'Ferritin', unit:'ng/mL', ref:{maleLow:30,maleHigh:400,femaleLow:10,femaleHigh:150}},
  {key:'amilaz', label:'Amilaz', unit:'U/L', ref:{low:25,high:125}},
  {key:'lipaz', label:'Lipaz', unit:'U/L', ref:{low:13,high:60}}
];

// ----- DOM referanslarÄ± -----
const testsContainer = document.getElementById('testsContainer');
const genderSelect = document.getElementById('gender');
const pregnancySelect = document.getElementById('pregnancy');
const ageInput = document.getElementById('age');
const summaryArea = document.getElementById('summaryArea');

// ----- Gebelik alanÄ±nÄ± erkek seÃ§ilince pasif yap -----
function handlePregnancyVisibility(){
  if(genderSelect.value === 'male'){
    pregnancySelect.value = 'no';
    pregnancySelect.disabled = true;
  } else {
    pregnancySelect.disabled = false;
  }
}
genderSelect.addEventListener('change', handlePregnancyVisibility);
handlePregnancyVisibility(); // sayfa yÃ¼klenince uygula

// ----- Test girdilerini oluÅŸtur -----
function renderTests(){
  testsContainer.innerHTML = '';
  tests.forEach(t=>{
    // determine display refs (placeholders shown; actual evaluation uses gender/age/pregnancy)
    let refText = '';
    if(t.ref.hasOwnProperty('low') && t.ref.hasOwnProperty('high')){
      refText = `${t.ref.low} - ${t.ref.high}`;
    } else if(t.ref.hasOwnProperty('maleLow')){
      refText = `Erkek: ${t.ref.maleLow}-${t.ref.maleHigh}, KadÄ±n: ${t.ref.femaleLow}-${t.ref.femaleHigh}`;
    }
    const div = document.createElement('div');
    div.className = 'test-item';
    div.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700">${t.label}</div>
          <div class="ref">Referans: ${refText} ${t.unit || ''}</div>
        </div>
        <div style="width:160px">
          <input type="number" id="${t.key}" placeholder="DeÄŸer">
        </div>
      </div>
    `;
    testsContainer.appendChild(div);
  });
}
renderTests();

// ----- YardÄ±mcÄ±: referans aralÄ±ÄŸÄ±nÄ± al (cinsiyet/gebelik/yaÅŸa gÃ¶re hafif dÃ¼zeltmeler uygula) -----
function getRefRange(t, gender, preg, age){
  // default
  if(t.ref.hasOwnProperty('low') && t.ref.hasOwnProperty('high')){
    let low = t.ref.low, high = t.ref.high;
    // gebelik etkisi Ã¶rneÄŸi:
    if(preg==='yes'){
      // bazÄ± testlerde gebelikte normal aralÄ±k farklÄ±dÄ±r (basitleÅŸtirilmiÅŸ)
      if(t.key === 'glukoz'){
        // gestasyonel diyabet eÅŸiÄŸi mantÄ±ÄŸÄ± handled elsewhere; burada gÃ¶sterim koru
        low = 70; high = 92; // normal gebelik aÃ§lÄ±k sÄ±nÄ±rÄ± olarak (gÃ¶sterim amaÃ§lÄ±)
      }
      if(t.key === 'kreatinin'){
        high = 1.0; // gebelikte kreatinin referansÄ± genelde daha dÃ¼ÅŸÃ¼ktÃ¼r
      }
      if(t.key === 'albumin' || t.key === 'totalProtein'){
        // hemodilÃ¼syon -> alt sÄ±nÄ±r biraz daha dÃ¼ÅŸÃ¼k gÃ¶rÃ¼nÃ¼r
        low = (low - 0.3) >= 0 ? low - 0.3 : low;
      }
      if(t.key === 'alp'){
        // ALP gebelikte yÃ¼kselebilir (plasental kaynak)
        high = high * 1.5;
      }
    }
    // pediyatrik veya ileri yaÅŸ ayarlamasÄ± - basit kural (daha ayrÄ±ntÄ± istiyorsan ekleriz)
    if(age && age < 18){
      // Ã§ocuklarda bazÄ± referanslar farklÄ±dÄ±r; burada uyarÄ± amaÃ§lÄ± daraltma yapmÄ±yoruz, sadece gÃ¶sterim notu
    }
    return {low, high};
  } else if(t.ref.hasOwnProperty('maleLow')){
    // cinsiyete gÃ¶re aralÄ±k
    const low = (gender==='male')?t.ref.maleLow:t.ref.femaleLow;
    const high = (gender==='male')?t.ref.maleHigh:t.ref.femaleHigh;
    // gebelik etkisi: kadÄ±n gebe ise kreatinin/Ã¼rik asit dÃ¼ÅŸer genelde -> handled elsewhere
    if(preg==='yes' && t.key==='kreatinin') return {low:low, high:1.0};
    return {low, high};
  } else {
    return {low: NaN, high: NaN};
  }
}

// ----- Analiz mantÄ±ÄŸÄ± -----
function analyze(){
  const gender = genderSelect.value;
  const preg = pregnancySelect.value;
  const age = Number(ageInput.value) || null;

  // topla deÄŸerler
  const vals = {};
  tests.forEach(t=>{
    const el = document.getElementById(t.key);
    const v = el && el.value!=='' ? Number(el.value) : null;
    vals[t.key] = v;
  });

  // sonuÃ§ HTML hazÄ±rla
  let html = '';
  let missingAny = false;
  // tek tek deÄŸerlendirme
  tests.forEach(t=>{
    const v = vals[t.key];
    const range = getRefRange(t, gender, preg, age);
    if(v===null || isNaN(v)){
      missingAny = true;
      // gÃ¶sterim: halen referans aralÄ±ÄŸÄ±nÄ± gÃ¶ster
      html += `<div class="result good"><strong>${t.label}:</strong> -  <br><span class="ref">Referans: ${isNaN(range.low)?'-':range.low} â€“ ${isNaN(range.high)?'-':range.high} ${t.unit||''}</span></div>`;
      return;
    }
    let status = 'good', note = 'DeÄŸer referans aralÄ±ÄŸÄ±nda.';
    if(!isNaN(range.low) && !isNaN(range.high)){
      if(v < range.low){ status='warn'; note='Referans aralÄ±ÄŸÄ±nÄ±n altÄ±nda.'; }
      else if(v > range.high){ status='bad'; note='Referans aralÄ±ÄŸÄ±nÄ±n Ã¼stÃ¼nde.'; }
    } else {
      note = 'Referans aralÄ±ÄŸÄ± tanÄ±mlÄ± deÄŸil.';
    }

    // gebeliÄŸe Ã¶zgÃ¼ glukoz uyarÄ±sÄ± (kÄ±lavuz mantÄ±ÄŸÄ±)
    if(t.key==='glukoz' && preg==='yes' && !isNaN(v)){
      if(v >= 126){
        status='bad'; note='Gebelikte aÃ§lÄ±k glukozu â‰¥126 mg/dL â€” overt diyabet ÅŸÃ¼phesi (hekim deÄŸerlendirmesi gerek).';
      } else if(v >= 92){
        status='warn'; note='Gebelikte aÃ§lÄ±k glukozu â‰¥92 mg/dL â€” gestasyonel diyabet riski (OGTT Ã¶nerilir).';
      } else {
        // normal
      }
    }

    html += `<div class="result ${status}"><strong>${t.label}:</strong> ${v} ${t.unit || ''} <br><em>${note}</em><div class="ref">Referans: ${range.low} â€“ ${range.high} ${t.unit||''}</div></div>`;
  });

  // kombine deÄŸerlendirme (bÃ¼tÃ¼ncÃ¼l)
  const combs = [];
  // bÃ¶brek
  const crLimit = (gender==='male')?1.3:1.1;
  if(preg==='yes'){ /* pregn'de handled earlier */ }
  if(vals.ure !== null && vals.kreatinin !== null && vals.ure > 50 && vals.kreatinin > crLimit){
    combs.push('Ãœre ve kreatinin birlikte yÃ¼ksek: bÃ¶brek fonksiyon bozukluÄŸu olasÄ±lÄ±ÄŸÄ±.');
  }
  if(vals.alt !== null && vals.ast !== null && (vals.alt > 45 || vals.ast > 40)){
    combs.push('ALT ve/veya AST yÃ¼ksek: karaciÄŸer hÃ¼cre hasarÄ± olasÄ±lÄ±ÄŸÄ±.');
  }
  if(vals.trigliserid !== null && vals.hdlKolesterol !== null){
    // note: our test key for HDL in this dataset is hdlKolesterol; ensure exists
    if(vals.trigliserid > 150 && vals.hdlKolesterol < ((gender==='male')?40:50)){
      combs.push('Trigliserid yÃ¼ksek ve HDL dÃ¼ÅŸÃ¼k: dislipidemi / metabolik sendrom riski.');
    }
  }
  if(vals.glukoz !== null && vals.glukoz > 100){
    if(preg==='yes'){
      // gestasyonel handled above; keep note general
      combs.push('YÃ¼ksek aÃ§lÄ±k glukozu: glisemik bozukluk riski (gebelikte â‰¥92 mg/dL Ã¶nemli).');
    } else {
      combs.push('YÃ¼ksek aÃ§lÄ±k glukozu: prediyabet/diyabet riski.');
    }
  }
  if(vals.urikAsit !== null){
    const uaLimit = (gender==='male')?7.2:6.0;
    if(vals.urikAsit > uaLimit) combs.push('Ãœrik asit yÃ¼ksek: gut veya bÃ¶brek taÅŸÄ± riski olabilir.');
  }
  if(vals.albumin !== null && vals.totalProtein !== null){
    if(vals.albumin < 3.5 && vals.totalProtein < 6.4) combs.push('Albumin ve total protein dÃ¼ÅŸÃ¼k: beslenme yetersizliÄŸi veya karaciÄŸer sentez fonksiyonunda azalma olasÄ±lÄ±ÄŸÄ±.');
  }

  if(combs.length){
    html += `<div style="margin-top:8px"><strong>OlasÄ± iliÅŸkili durumlar / genel deÄŸerlendirme:</strong><ul>`;
    combs.forEach(c=> html += `<li style="margin-top:6px">${c}</li>`);
    html += `</ul></div>`;
  } else {
    if(!missingAny) html += `<div class="result good">Girilen verilere gÃ¶re belirgin bir toplu risk saptanmadÄ±.</div>`;
    else html += `<div class="small-muted">BazÄ± testler girilmedi; daha kapsamlÄ± deÄŸerlendirme iÃ§in tÃ¼m temel testlerin girilmesi Ã¶nerilir.</div>`;
  }

  // son not
  html += `<div class="small-muted" style="margin-top:10px"><strong>Not:</strong> Bu deÄŸerlendirme bilgi amaÃ§lÄ±dÄ±r. Kesin tanÄ± iÃ§in klinik deÄŸerlendirme, ilave testler ve hekim gÃ¶rÃ¼ÅŸÃ¼ gereklidir.</div>`;

  summaryArea.innerHTML = html;
}

// ----- Buton dinleyici -----
document.getElementById('analyzeBtn').addEventListener('click', analyze);

// ----- kÃ¼Ã§Ã¼k uyarlamalar: bazÄ± inputlara farklÄ± id kullanÄ±mÄ± (hdl field key) -----
// ensure hdl field key matches used keys (we used hdlKolesterol earlier in logic). If user didn't have that test key, create alias
// In our tests list, key is 'hdlKolesterol' â€” ensure ID used matches.
</script>
</body>
</html>


